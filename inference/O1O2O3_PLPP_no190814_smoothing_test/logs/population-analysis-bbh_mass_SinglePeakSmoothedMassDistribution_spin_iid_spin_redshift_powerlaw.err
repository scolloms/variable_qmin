22:41 bilby INFO    : Loaded 69 posteriors
22:41 bilby INFO    : Using SinglePeakSmoothedMassDistribution from gwpopulation.models.mass.
22:41 bilby INFO    : Created gwpopulation.models.mass.SinglePeakSmoothedMassDistribution with arguments {'mmin': 2.0, 'mmax': 100.0}
22:41 bilby INFO    : Using iid_spin from gwpopulation.models.spin.
22:41 bilby INFO    : Using PowerLawRedshift from gwpopulation.models.redshift.
22:41 bilby INFO    : Created gwpopulation.models.redshift.PowerLawRedshift with arguments {'z_max': 1.9}
22:41 bilby INFO    : Using SinglePeakSmoothedMassDistribution from gwpopulation.models.mass.
22:41 bilby INFO    : Created gwpopulation.models.mass.SinglePeakSmoothedMassDistribution with arguments {'mmin': 2.0, 'mmax': 100.0}
22:41 bilby INFO    : Using PowerLawRedshift from gwpopulation.models.redshift.
22:41 bilby INFO    : Created gwpopulation.models.redshift.PowerLawRedshift with arguments {'z_max': 1.9}
22:41 bilby INFO    : Loading VT data from O1O2O3_PLPP_no190814_smoothing_test/data/injections.pkl.
22:41 bilby INFO    : Identified keys: lam, alpha, mmax, beta, delta_m, sigpp, mpp, mmin, sigma_chi, alpha_chi, amax, sigma_spin, beta_chi, mu_chi, xi_spin, lamb
22:41 bilby INFO    : Running for label 'bbh_mass_SinglePeakSmoothedMassDistribution_spin_iid_spin_redshift_powerlaw', output will be saved to 'O1O2O3_PLPP_no190814_smoothing_test/result'
/home/storm.colloms/.conda/envs/O4apop-jax/lib/python3.10/site-packages/_distutils_hack/__init__.py:26: UserWarning: Setuptools is replacing distutils.
  warnings.warn("Setuptools is replacing distutils.")
22:41 bilby INFO    : Analysis priors:
22:41 bilby INFO    : alpha=Uniform(minimum=-4, maximum=12, name='alpha', latex_label='$\\alpha$', unit=None, boundary=None)
22:41 bilby INFO    : beta=Uniform(minimum=-2, maximum=7, name='beta', latex_label='$\\beta_{q}$', unit=None, boundary=None)
22:41 bilby INFO    : mmax=Uniform(minimum=62, maximum=100, name='mmax', latex_label='$m_{\\max}$', unit=None, boundary=None)
22:41 bilby INFO    : mmin=Uniform(minimum=2, maximum=6, name='mmin', latex_label='$m_{\\min}$', unit=None, boundary=None)
22:41 bilby INFO    : lam=Uniform(minimum=0, maximum=1, name='lambda', latex_label='$\\lambda_{m}$', unit=None, boundary=None)
22:41 bilby INFO    : mpp=Uniform(minimum=20, maximum=50, name='mpp', latex_label='$\\mu_{m}$', unit=None, boundary=None)
22:41 bilby INFO    : sigpp=Uniform(minimum=1, maximum=10, name='sigpp', latex_label='$\\sigma_{m}$', unit=None, boundary=None)
22:41 bilby INFO    : delta_m=Uniform(minimum=0, maximum=10, name='delta_m', latex_label='$\\delta_{m}$', unit=None, boundary=None)
22:41 bilby INFO    : mu_chi=Uniform(minimum=0, maximum=1, name='mu_chi', latex_label='$\\mu_{\\chi}$', unit=None, boundary=None)
22:41 bilby INFO    : sigma_chi=Uniform(minimum=0.005, maximum=0.25, name='sigma_chi', latex_label='$\\sigma^{2}_{\\chi}$', unit=None, boundary=None)
22:41 bilby INFO    : xi_spin=Uniform(minimum=0, maximum=1, name='xi_spin', latex_label='$\\zeta$', unit=None, boundary=None)
22:41 bilby INFO    : sigma_spin=Uniform(minimum=0.1, maximum=4.0, name='sigma_t', latex_label='$\\sigma_t$', unit=None, boundary=None)
22:41 bilby INFO    : lamb=Uniform(minimum=-2, maximum=8, name='lamb', latex_label='$\\lambda_z$', unit=None, boundary=None)
22:41 bilby INFO    : alpha_chi=Constraint(minimum=1, maximum=100000.0, name=None, latex_label=None, unit=None)
22:41 bilby INFO    : beta_chi=Constraint(minimum=1, maximum=100000.0, name=None, latex_label=None, unit=None)
22:41 bilby INFO    : amax=1.0
22:41 bilby INFO    : Analysis likelihood class: <class 'gwpopulation.experimental.jax.JittedLikelihood'>
22:41 bilby INFO    : Analysis likelihood noise evidence: nan
22:41 bilby INFO    : Single likelihood evaluation took nan s
2024-07-21 22:42:04.134183: E external/xla/xla/service/slow_operation_alarm.cc:65] Constant folding an instruction is taking > 1s:

  %add.2286 = f64[69,19815]{1,0} add(f64[69,19815]{1,0} %broadcast.31, f64[69,19815]{1,0} %constant.142), metadata={op_name="jit(<unnamed wrapped function>)/jit(main)/add"}

This isn't necessarily a bug; constant-folding is inherently a trade-off between compilation time and speed at runtime. XLA has some guards that attempt to keep constant folding from taking too long, but fundamentally you'll always be able to come up with an input program that takes a long time.

If you'd like to file a bug, run with envvar XLA_FLAGS=--xla_dump_to=/tmp/foo and attach the results.
2024-07-21 22:42:04.358299: E external/xla/xla/service/slow_operation_alarm.cc:133] The operation took 1.46612908s
Constant folding an instruction is taking > 1s:

  %add.2286 = f64[69,19815]{1,0} add(f64[69,19815]{1,0} %broadcast.31, f64[69,19815]{1,0} %constant.142), metadata={op_name="jit(<unnamed wrapped function>)/jit(main)/add"}

This isn't necessarily a bug; constant-folding is inherently a trade-off between compilation time and speed at runtime. XLA has some guards that attempt to keep constant folding from taking too long, but fundamentally you'll always be able to come up with an input program that takes a long time.

If you'd like to file a bug, run with envvar XLA_FLAGS=--xla_dump_to=/tmp/foo and attach the results.
22:42 bilby INFO    : Using sampler Dynesty with kwargs {'nlive': 500, 'bound': 'live', 'sample': 'act-walk', 'periodic': None, 'reflective': None, 'update_interval': 600, 'first_update': None, 'npdim': None, 'rstate': None, 'queue_size': 1, 'pool': None, 'use_pool': None, 'live_points': None, 'logl_args': None, 'logl_kwargs': None, 'ptform_args': None, 'ptform_kwargs': None, 'gradient': None, 'grad_args': None, 'grad_kwargs': None, 'compute_jac': False, 'enlarge': None, 'bootstrap': None, 'walks': 5, 'facc': 0.2, 'slices': None, 'fmove': 0.9, 'max_move': 100, 'update_func': None, 'ncdim': None, 'blob': False, 'save_history': False, 'history_filename': None, 'maxiter': None, 'maxcall': None, 'dlogz': 0.1, 'logl_max': inf, 'n_effective': None, 'add_live': True, 'print_progress': True, 'print_func': <bound method Dynesty._print_func of <bilby.core.sampler.dynesty.Dynesty object at 0x1543b0a128c0>>, 'save_bounds': False, 'checkpoint_file': None, 'checkpoint_every': 60, 'resume': False, 'seed': None}
22:42 bilby INFO    : Checkpoint every check_point_delta_t = 600s
22:42 bilby INFO    : Using dynesty version 2.1.3
22:42 bilby INFO    : Using the bilby-implemented act-walk sampling tracking the autocorrelation function and thinning by 2 with maximum length 10000
22:42 bilby INFO    : Reading resume file O1O2O3_PLPP_no190814_smoothing_test/result/bbh_mass_SinglePeakSmoothedMassDistribution_spin_iid_spin_redshift_powerlaw_resume.pickle
22:42 bilby WARNING : The resume file O1O2O3_PLPP_no190814_smoothing_test/result/bbh_mass_SinglePeakSmoothedMassDistribution_spin_iid_spin_redshift_powerlaw_resume.pickle is corrupted or the version of bilby has changed between runs. This resume file will be ignored.
22:42 bilby INFO    : Generating initial points from the prior
/home/storm.colloms/.conda/envs/O4apop-jax/lib/python3.10/site-packages/dynesty/sampler.py:756: UserWarning: The sampling was stopped short due to maxiter/maxcall limit the delta(log(z)) criterion is not achieved; posterior may be poorly sampled
  warnings.warn('The sampling was stopped short due to'
23:59 bilby INFO    : Written checkpoint file O1O2O3_PLPP_no190814_smoothing_test/result/bbh_mass_SinglePeakSmoothedMassDistribution_spin_iid_spin_redshift_powerlaw_resume.pickle
/home/storm.colloms/.conda/envs/O4apop-jax/lib/python3.10/site-packages/dynesty/sampler.py:756: UserWarning: The sampling was stopped short due to maxiter/maxcall limit the delta(log(z)) criterion is not achieved; posterior may be poorly sampled
  warnings.warn('The sampling was stopped short due to'
00:58 bilby INFO    : Written checkpoint file O1O2O3_PLPP_no190814_smoothing_test/result/bbh_mass_SinglePeakSmoothedMassDistribution_spin_iid_spin_redshift_powerlaw_resume.pickle
/home/storm.colloms/.conda/envs/O4apop-jax/lib/python3.10/site-packages/dynesty/sampler.py:756: UserWarning: The sampling was stopped short due to maxiter/maxcall limit the delta(log(z)) criterion is not achieved; posterior may be poorly sampled
  warnings.warn('The sampling was stopped short due to'
02:12 bilby INFO    : Written checkpoint file O1O2O3_PLPP_no190814_smoothing_test/result/bbh_mass_SinglePeakSmoothedMassDistribution_spin_iid_spin_redshift_powerlaw_resume.pickle
/home/storm.colloms/.conda/envs/O4apop-jax/lib/python3.10/site-packages/dynesty/sampler.py:756: UserWarning: The sampling was stopped short due to maxiter/maxcall limit the delta(log(z)) criterion is not achieved; posterior may be poorly sampled
  warnings.warn('The sampling was stopped short due to'
03:03 bilby INFO    : Written checkpoint file O1O2O3_PLPP_no190814_smoothing_test/result/bbh_mass_SinglePeakSmoothedMassDistribution_spin_iid_spin_redshift_powerlaw_resume.pickle
/home/storm.colloms/.conda/envs/O4apop-jax/lib/python3.10/site-packages/dynesty/sampler.py:756: UserWarning: The sampling was stopped short due to maxiter/maxcall limit the delta(log(z)) criterion is not achieved; posterior may be poorly sampled
  warnings.warn('The sampling was stopped short due to'
04:03 bilby INFO    : Written checkpoint file O1O2O3_PLPP_no190814_smoothing_test/result/bbh_mass_SinglePeakSmoothedMassDistribution_spin_iid_spin_redshift_powerlaw_resume.pickle
/home/storm.colloms/.conda/envs/O4apop-jax/lib/python3.10/site-packages/dynesty/sampler.py:756: UserWarning: The sampling was stopped short due to maxiter/maxcall limit the delta(log(z)) criterion is not achieved; posterior may be poorly sampled
  warnings.warn('The sampling was stopped short due to'
05:07 bilby INFO    : Written checkpoint file O1O2O3_PLPP_no190814_smoothing_test/result/bbh_mass_SinglePeakSmoothedMassDistribution_spin_iid_spin_redshift_powerlaw_resume.pickle
/home/storm.colloms/.conda/envs/O4apop-jax/lib/python3.10/site-packages/dynesty/sampler.py:756: UserWarning: The sampling was stopped short due to maxiter/maxcall limit the delta(log(z)) criterion is not achieved; posterior may be poorly sampled
  warnings.warn('The sampling was stopped short due to'
06:17 bilby INFO    : Written checkpoint file O1O2O3_PLPP_no190814_smoothing_test/result/bbh_mass_SinglePeakSmoothedMassDistribution_spin_iid_spin_redshift_powerlaw_resume.pickle
/home/storm.colloms/.conda/envs/O4apop-jax/lib/python3.10/site-packages/dynesty/sampler.py:756: UserWarning: The sampling was stopped short due to maxiter/maxcall limit the delta(log(z)) criterion is not achieved; posterior may be poorly sampled
  warnings.warn('The sampling was stopped short due to'
07:51 bilby INFO    : Written checkpoint file O1O2O3_PLPP_no190814_smoothing_test/result/bbh_mass_SinglePeakSmoothedMassDistribution_spin_iid_spin_redshift_powerlaw_resume.pickle
/home/storm.colloms/.conda/envs/O4apop-jax/lib/python3.10/site-packages/dynesty/sampler.py:756: UserWarning: The sampling was stopped short due to maxiter/maxcall limit the delta(log(z)) criterion is not achieved; posterior may be poorly sampled
  warnings.warn('The sampling was stopped short due to'
08:59 bilby INFO    : Written checkpoint file O1O2O3_PLPP_no190814_smoothing_test/result/bbh_mass_SinglePeakSmoothedMassDistribution_spin_iid_spin_redshift_powerlaw_resume.pickle
/home/storm.colloms/.conda/envs/O4apop-jax/lib/python3.10/site-packages/dynesty/sampler.py:756: UserWarning: The sampling was stopped short due to maxiter/maxcall limit the delta(log(z)) criterion is not achieved; posterior may be poorly sampled
  warnings.warn('The sampling was stopped short due to'
10:10 bilby INFO    : Written checkpoint file O1O2O3_PLPP_no190814_smoothing_test/result/bbh_mass_SinglePeakSmoothedMassDistribution_spin_iid_spin_redshift_powerlaw_resume.pickle
/home/storm.colloms/.conda/envs/O4apop-jax/lib/python3.10/site-packages/dynesty/sampler.py:756: UserWarning: The sampling was stopped short due to maxiter/maxcall limit the delta(log(z)) criterion is not achieved; posterior may be poorly sampled
  warnings.warn('The sampling was stopped short due to'
11:27 bilby INFO    : Written checkpoint file O1O2O3_PLPP_no190814_smoothing_test/result/bbh_mass_SinglePeakSmoothedMassDistribution_spin_iid_spin_redshift_powerlaw_resume.pickle
/home/storm.colloms/.conda/envs/O4apop-jax/lib/python3.10/site-packages/dynesty/sampler.py:756: UserWarning: The sampling was stopped short due to maxiter/maxcall limit the delta(log(z)) criterion is not achieved; posterior may be poorly sampled
  warnings.warn('The sampling was stopped short due to'
12:18 bilby INFO    : Written checkpoint file O1O2O3_PLPP_no190814_smoothing_test/result/bbh_mass_SinglePeakSmoothedMassDistribution_spin_iid_spin_redshift_powerlaw_resume.pickle
/home/storm.colloms/.conda/envs/O4apop-jax/lib/python3.10/site-packages/dynesty/sampler.py:756: UserWarning: The sampling was stopped short due to maxiter/maxcall limit the delta(log(z)) criterion is not achieved; posterior may be poorly sampled
  warnings.warn('The sampling was stopped short due to'
13:23 bilby INFO    : Written checkpoint file O1O2O3_PLPP_no190814_smoothing_test/result/bbh_mass_SinglePeakSmoothedMassDistribution_spin_iid_spin_redshift_powerlaw_resume.pickle
/home/storm.colloms/.conda/envs/O4apop-jax/lib/python3.10/site-packages/dynesty/sampler.py:756: UserWarning: The sampling was stopped short due to maxiter/maxcall limit the delta(log(z)) criterion is not achieved; posterior may be poorly sampled
  warnings.warn('The sampling was stopped short due to'
14:41 bilby INFO    : Written checkpoint file O1O2O3_PLPP_no190814_smoothing_test/result/bbh_mass_SinglePeakSmoothedMassDistribution_spin_iid_spin_redshift_powerlaw_resume.pickle
/home/storm.colloms/.conda/envs/O4apop-jax/lib/python3.10/site-packages/dynesty/sampler.py:756: UserWarning: The sampling was stopped short due to maxiter/maxcall limit the delta(log(z)) criterion is not achieved; posterior may be poorly sampled
  warnings.warn('The sampling was stopped short due to'
15:54 bilby INFO    : Written checkpoint file O1O2O3_PLPP_no190814_smoothing_test/result/bbh_mass_SinglePeakSmoothedMassDistribution_spin_iid_spin_redshift_powerlaw_resume.pickle
/home/storm.colloms/.conda/envs/O4apop-jax/lib/python3.10/site-packages/dynesty/sampler.py:756: UserWarning: The sampling was stopped short due to maxiter/maxcall limit the delta(log(z)) criterion is not achieved; posterior may be poorly sampled
  warnings.warn('The sampling was stopped short due to'
17:24 bilby INFO    : Written checkpoint file O1O2O3_PLPP_no190814_smoothing_test/result/bbh_mass_SinglePeakSmoothedMassDistribution_spin_iid_spin_redshift_powerlaw_resume.pickle
18:31 bilby INFO    : Run interrupted by signal 15: checkpoint and exit on 130
18:31 bilby INFO    : Written checkpoint file O1O2O3_PLPP_no190814_smoothing_test/result/bbh_mass_SinglePeakSmoothedMassDistribution_spin_iid_spin_redshift_powerlaw_resume.pickle
Traceback (most recent call last):
  File "/home/storm.colloms/.conda/envs/O4apop-jax/lib/python3.10/site-packages/dynesty/dynesty.py", line 910, in __call__
    return self.func(np.asarray(x).copy(), *self.args, **self.kwargs)
  File "/home/storm.colloms/.conda/envs/O4apop-jax/lib/python3.10/site-packages/bilby/core/sampler/dynesty.py", line 53, in _log_likelihood_wrapper
    return _sampling_convenience_dump.likelihood.log_likelihood_ratio()
  File "/home/storm.colloms/.local/lib/python3.10/site-packages/gwpopulation/experimental/jax.py", line 61, in log_likelihood_ratio
    np.nan_to_num(self.likelihood_func(self.parameters, **self.kwargs))
  File "/home/storm.colloms/.conda/envs/O4apop-jax/lib/python3.10/site-packages/bilby/core/sampler/dynesty.py", line 783, in write_current_state_and_exit
    super(Dynesty, self).write_current_state_and_exit(signum=signum, frame=frame)
  File "/home/storm.colloms/.conda/envs/O4apop-jax/lib/python3.10/site-packages/bilby/core/sampler/base_sampler.py", line 749, in write_current_state_and_exit
    sys.exit(self.exit_code)
SystemExit: 130
